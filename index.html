<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laudo Neuropsicol√≥gico - Sistema Nuvem</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <div class="app-wrapper">
        
        <aside class="sidebar no-print">
            <div class="sidebar-header">
                <h2>Manain Sys</h2>
            </div>
            
            <div class="scroll-area">
                
                <div class="form-group db-section">
                    <label>üìÇ Banco de Dados de Pacientes</label>
                    <select id="listaPacientesSalvos" onchange="carregarPacienteDoBanco()">
                        <option value="">Carregar Paciente...</option>
                    </select>
                    <div class="btn-row">
                        <button class="btn-save" onclick="salvarPaciente()">üíæ Salvar</button>
                        <button class="btn-delete" onclick="excluirPaciente()">üóëÔ∏è Excluir</button>
                    </div>
                    <div id="statusCheck" class="status">Aguardando a√ß√£o...</div>
                </div>

                <div class="form-group">
                    <label>Paciente:</label>
                    <input type="text" id="nomePaciente" oninput="atualizarRelatorio()" placeholder="Nome Completo">
                    
                    <label>Nascimento:</label>
                    <input type="date" id="dataNasc" oninput="atualizarRelatorio()">
                    
                    <label>Data Aplica√ß√£o:</label>
                    <input type="date" id="dataAplicacao" oninput="atualizarRelatorio()">
                </div>

                <div class="form-group">
                    <label>Instrumento de Avalia√ß√£o:</label>
                    <select id="testeSelecionado" onchange="resetarDadosTeste()">
                        <option value="" disabled selected>-- Selecione --</option>
                        
                        <optgroup label="Intelig√™ncia (QI) - Verbal e Executivo">
                            <option value="wisc">WISC-IV (6 a 16 anos)</option>
                            <option value="wais">WAIS-III (16 a 90 anos)</option>
                        </optgroup>

                        <optgroup label="Intelig√™ncia N√£o-Verbal (Ideal p/ TEA/Fala)">
                            <option value="sonr27">SON-R 2¬Ω-7 [a] (2 a 7 anos)</option>
                            <option value="sonr640">SON-R 6-40 (6 a 40 anos)</option>
                            <option value="raven">Matrizes de Raven (Geral)</option>
                        </optgroup>

                        <optgroup label="Comportamento Adaptativo (Essencial p/ DI)">
                            <option value="abas">ABAS-3 (Todas as idades)</option>
                            <option value="vinhais">Vinhais-3 (Todas as idades)</option>
                        </optgroup>
                    </select>

                    <p style="font-size: 0.75rem; color: #666; margin-top: 5px; font-style: italic; margin-bottom: 10px;">
                        *Selecione o teste para liberar o preenchimento.
                    </p>

                    <button class="btn-primary" onclick="abrirChecklist()">Preencher Gr√°fico & Dados</button>
                </div>

                <div class="form-group">
                    <button class="btn-print" onclick="window.print()">üñ®Ô∏è IMPRIMIR LAUDO</button>
                </div>
            </div>
        </aside>

        <main class="preview-container">
            
            <table class="tabela-layout">
                
                <thead>
                    <tr>
                        <td>
                            <div class="header-space">&nbsp;</div>
                            <div class="header-fixed">
                                <div class="timbrado-top">
                                    <img src="col.png" alt="Logo COL" class="logo-topo">
                                    
                                    <h3>CENTRO OCUPACIONAL DE LONDRINA</h3>
                                    <p class="sub">Escola Manain - Educa√ß√£o Infantil e Ensino Fundamental,<br>na Modalidade Educa√ß√£o Especial</p>
                                    <div class="legal">
                                        <p>Fundado Em 22/06/1985 - CNPJ 78.962.263/0001-79</p>
                                        <p>Utilidade P√∫blica Municipal Lei N¬∫ 3.956 de 24/04/1987</p>
                                    </div>
                                    <hr class="line">
                                </div>
                            </div>
                        </td>
                    </tr>
                </thead>

                <tfoot>
                    <tr>
                        <td>
                            <div class="footer-space">&nbsp;</div>
                            <div class="footer-fixed">
                                <div class="timbrado-bottom">
                                    <hr class="line">
                                    <p>Rua das A√ßucenas N¬∫. 100 - Jd. Colina Verde - Fone/Fax: (43) 3328-4415.</p>
                                    <p>CEP: 86050-570-Londrina/ PR &nbsp;|&nbsp; centroocupacional.secretaria@gmail.com</p>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tfoot>

                <tbody>
                    <tr>
                        <td class="content-cell">
                            
                            <div class="documento-corpo">
                                <h1 class="titulo-principal">RELAT√ìRIO DE AVALIA√á√ÉO NEUROPSICOL√ìGICA</h1>

                                <section>
                                    <h4 class="titulo-secao">1. IDENTIFICA√á√ÉO</h4>
                                    <table class="tabela-dados">
                                        <tr>
                                            <td width="60%"><strong>Paciente:</strong> <span id="viewNome"></span></td>
                                            <td><strong>Nasc.:</strong> <span id="viewNasc"></span></td>
                                        </tr>
                                        <tr>
                                            <td><strong>Idade:</strong> <span id="viewIdade"></span></td>
                                            <td><strong>Data Avalia√ß√£o:</strong> <span id="viewData"></span></td>
                                        </tr>
                                    </table>
                                </section>

                                <section>
                                    <h4 class="titulo-secao">2. MOTIVO DA AVALIA√á√ÉO</h4>
                                    <div id="viewMotivo" class="texto-tecnico">
                                        <p class="placeholder">[Preencha o nome e selecione o teste...]</p>
                                    </div>
                                </section>

                                <section>
                                    <h4 class="titulo-secao">3. AN√ÅLISE QUANTITATIVA E GR√ÅFICA</h4>
                                    <div id="viewAnalise1" class="texto-tecnico">
                                        <p class="placeholder">[Aguardando Checklist...]</p>
                                    </div>

                                    <div id="boxGrafico" class="grafico-wrapper" style="display:none;">
                                        <canvas id="graficoLinha"></canvas>
                                        <p class="legenda-grafico">Figura 1: Comparativo entre Desempenho Ideal (Linha Cinza) e Obtido (Linha Azul).</p>
                                    </div>

                                    <div id="viewAnalise2" class="texto-tecnico"></div>
                                </section>

                                <section>
                                    <h4 class="titulo-secao">4. ENCAMINHAMENTOS</h4>
                                    <div id="viewEncaminhamentos" class="texto-tecnico">
                                        <p class="placeholder">[Aguardando An√°lise...]</p>
                                    </div>
                                </section>

                                <section>
                                    <h4 class="titulo-secao">5. CONCLUS√ÉO</h4>
                                    <div id="viewConclusao" class="texto-tecnico">
                                        <p class="placeholder">[Aguardando An√°lise...]</p>
                                    </div>
                                </section>

                                <div class="assinatura-box">
                                    <img src="asspsicologa.png" alt="Assinatura" class="img-ass" onerror="this.style.display='none'">
                                    <p><strong>Jaqueline Gon√ßalves Malaquim</strong></p>
                                    <p>Psic√≥loga - CRP 08/30548</p>
                                </div>
                            </div>

                        </td>
                    </tr>
                </tbody>
            </table>

        </main>
    </div>

    <div id="modalChecklist" class="modal">
        <div class="modal-card">
            <h3>Pontua√ß√£o do Teste</h3>
            <div id="listaChecklist"></div>
            <div class="modal-botoes">
                <button class="btn-success" onclick="salvarChecklist()">Gerar Gr√°fico e An√°lise</button>
                <button class="btn-cancel" onclick="document.getElementById('modalChecklist').style.display='none'">Cancelar</button>
            </div>
        </div>
    </div>

    <script type="module" src="script.js"></script>
</body>
</html>